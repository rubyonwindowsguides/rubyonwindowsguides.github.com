<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Rubyinstaller</title>
   <meta name="author" content="Boško Ivanišević" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/menu.css" type="text/css" media="screen, projection" />

   <!-- Update your html tag to include the itemscope and itemtype attributes -->
   <html itemscope itemtype="http://schema.org/Book">

   <!-- Add the following three tags inside head -->
   <meta itemprop="name" content="Ruby On Windows Guides">

   <!-- Place this render call where appropriate -->
   <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
   </script>

   <script type="text/javascript">

     var _gaq = _gaq || [];
     _gaq.push(['_setAccount', 'UA-26061460-1']);
     _gaq.push(['_trackPageview']);

     (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
     })();

   </script>
</head>
<body>
  <header>
  </header>
  <main class="content">
    <section class="container">
      <nav class="navbar-fixed-top">
        <div class="container">
          <a href="/">Book</a>
          <a href="/about.html">About</a>
          <span style="float: right;">
            <!-- Place this tag where you want the +1 button to render -->
            <g:plusone annotation="inline"></g:plusone>
          </span>
        </div>
      </nav>
      <div id="header">
        <table>
          <tr>
            <td>
              <h1>Ruby on Windows Guides</h1>
              <h4 class="title">by Boško Ivanišević</h4>
            </td>
          </tr>
        </table>
      </div>
      <div id="main" class="row-fluid">
        <article class="post">
      <section style="font-weight:bold; margin-bottom: 2em;">
        
        <a rel="prev" class="a-hover"href="/book/ch02-00.html"><i class="icon-double-angle-left"></i> Installing Ruby</a>
        
        
        <a rel="next" style="float:right" class="a-hover"href="/book/ch02-02.html">Building Ruby <i class=" icon-double-angle-right"></i></a>
        
            <hr>
      </section>

          <section>
            <h2>RubyInstaller</h2>

<p>Main version of Ruby we&#39;ll be using in this book is 2.2.1, so that&#39;s the first version we will install. Go to download section of RubyInstaller site and download Ruby 2.2.1-p85 installer. Double click on the downloaded executable file (rubyinstaller-2.2.1.exe) and follow instructions on the screen. However there are few things you must pay attention to.</p>

<p>It is recommended to install Ruby on the path without spaces. By default installer offers you to install Ruby to <code>C:\Ruby22</code>. You can change this path to suite your needs but be aware of the fact that MinGW tools, needed for instaling some types of gems (which we will cover later), do not handle paths with spaces well so you might face various problems if you install Ruby to standard Windows location <code>C:\Program Files</code>. We will install it in <code>C:\Ruby\22</code> since we will keep all versions in the same root directory.</p>

<p>Next important thing is to add Ruby executables to the path. This way you will be able to use Ruby in every Command Prompt without need to alter system path every time. However it is not essential at this moment since, during this tutorial, we will handle this in a different way.</p>

<p>In addition you can associate <code>.rb</code> and <code>.rbw</code> files with this Ruby installation which will give you a possibility to execute Ruby scripts just by double-clicking Ruby files. This step can be skipped if you do not want to start Ruby scripts from GUI. Figure 2-1 shows installer&#39;s page with these options.</p>

<p><img src="/images/fig0201.png" alt="&quot;&quot;" title="Ruby installation options"></p>

<p>When installation is complete open up new Command Prompt or ConEmu window and check that everything is installed correctly:</p>

<div class="highlight"><pre><code class="bat">C:\<span class="p">&gt;</span><span class="n">ruby</span> -v
ruby <span class="m">2</span>.<span class="m">2</span>.<span class="m">1</span>p<span class="m">85</span> (<span class="m">2015-02-26</span> revision <span class="m">49769</span>) [i<span class="m">386</span>-mingw<span class="m">32</span>]
C:\&gt;</code></pre></div>

<p>Let&#39;s stop here for the moment and check what installer has actually done. Lot of experienced developers agree that good way to learn programming is to explore other&#39;s code. This is not related only to programming and we will use same approach here.</p>

<p>Apart from the fact that installer has put all Ruby files in the selected directory, <code>C:\Ruby\22</code> in our case it added this path to system path and that&#39;s why we are able to start ruby in new command prompt. Besides it created few shortcuts in the start menu. You can find them under <code>Ruby2.2.1-p85</code> sub-menu item.</p>

<p>First shortcut has a title “Interactive Ruby”. Click on it. New Command Prompt opens with Interactive Ruby (<code>irb</code>) already started. This program is actually Ruby interpreter which you can use to experiment with your code in real-time. Each statement is immediately executed and you can see its results. This is excellent tool if you started to learn Ruby. Click again on Start Menu and on <code>Ruby2.2.1-p85</code> sub-menu. Right-click on Interactive Ruby and Properties in the context menu. Look at the text box next to Target label on Shortcut tab. This is command used to start <code>irb</code>. We will use it in ConEmu. Open ConEmu Setup tasks dialog by clicking on drop-down icon beside green icon with plus sign in the upper right corner. Click on button with plus sign to add new task type to ConEmu and in the text box type same command as you have in the Properties dialog box for irb shortcut. In our case it is:</p>

<div class="highlight"><pre><code class="bat">C:\Ruby\<span class="m">22</span>\bin\irb.bat</code></pre></div>

<p>In the Title text box type <code>irb22</code>. If you want to exit irb session just type quit and pres Return button on your keyboard. Not that if you didn&#39;t check “Add Ruby executables to your PATH”, irb tab just created in ConEmu will still work.</p>

<p>Let&#39;s create one more tab in ConEmu in which you can use Ruby even if it is not on you path. Go again to setup tasks dialo and add a new task. In the shell text box type: <code>C:\Windows\System32\cmd.exe /E:ON /K c:\Ruby\22\bin\setrbvars.bat</code> and type Ruby 2.2.1 Console for the title. If you now activate new ConEmu task command prompt with installed ruby activated in the command prompt.</p>

<div class="highlight"><pre><code class="bat">ruby <span class="m">2</span>.<span class="m">2</span>.<span class="m">1</span>p<span class="m">85</span> (<span class="m">2015-02-26</span> revision <span class="m">49769</span>) [i<span class="m">386</span>-mingw<span class="m">32</span>]
c:\&gt;</code></pre></div>

<p>Finally if you have checked “Associate .rb and .rbw files with this Ruby installation” during installation installer has made changes to your <code>PATHEXT</code> system variable. This variable contains list of file extensions and it tells Windows what is it supposed to do with files who&#39;s extension match one of the listed values. Basically this is list of executable files and the most common extensions are <code>.EXE</code>, <code>.BAT</code> and <code>.CMD</code>.</p>

<p>Installer has added two more, <code>.RB</code> and <code>.RBW</code>. New file types are defined in the Windows registry. In order to completely understand this association open Registry Editor by clicking on Start button and typing <code>regedit</code> and pressing Enter. Expand <code>Computer</code> and <code>HKEY_CLASSES_ROOT</code> node in the left tree control and scroll down to the <code>.rb</code> and <code>.rbw</code> nodes. Clicking on them will display values stored for these nodes, <code>RubyFile</code> and <code>RubyWFile</code> respectively. Now scroll down till you find keys named <code>RubyFile</code> and <code>RubyWFile</code> expand all nodes. You should end up with the tree that looks like shown in Figure 2-3.</p>

<p><img src="/images/fig0202.png" alt="&quot;&quot;" title="Ruby installation options"></p>

<p>Each key has several sub-keys. The first one, <code>DefaultIcon</code>, tells Windows Explorer which icon to display for Ruby files. Next value is stored in the <code>shell\open\command</code> key and it tells Windows what to do with these Ruby files. Values are: <code>&quot;c:\Ruby\22\bin\ruby.exe&quot; &quot;%1&quot; %*</code> for RubyFile (extension <code>.RB</code>) and <code>&quot;c:\Ruby\22\bin\rubyw.exe&quot; &quot;%1&quot; %*</code> for RubyWFile (extension <code>.RBW</code>) and they tell Windows to invoke Ruby interpreter and pass it file name (argument <code>“%1”</code>) and other arguments (<code>%*</code>).</p>

<p>Notice that these values use different Ruby executables. The first one, <code>ruby.exe</code>, is “standard” Ruby interpreter which is meant to be used in Command Prompt. Each time it is invoked new Command Prompt window will be opened and Ruby script will be executed in it. But if you want to call Ruby from another process or you want to execute Ruby script as a background task rubyw.exe is more appropriate. It is exactly the same Ruby interpreter except it doesn&#39;t provide standard in, out and error streams. Besides it doesn&#39;t launch new Command Prompt when executed.</p>

<p>Let us test our new file association. Create new directory where we will keep our Ruby sources in <code>C:\projects</code>. Within that directory create subdirectory called misc and edit new file called <code>ruby_args.rb</code> with following code:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">if</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">empty?</span>
  <span class="nb">puts</span> <span class="s2">&quot;No arguments supplied&quot;</span>
<span class="k">else</span>
  <span class="no">ARGV</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">arg</span><span class="p">,</span> <span class="n">idx</span><span class="o">|</span>
    <span class="nb">puts</span> <span class="s2">&quot;Argument </span><span class="si">#{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> is: </span><span class="si">#{</span><span class="n">arg</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>Double click this file in Windows Explorer. New Command Prompt window will open, “No arguments supplied” will be printed out and window will close. Change extension to <code>.rbw</code> and double click again. Have you seen the difference? No window was opened even though script was executed. Change extension back to <code>.rb</code>. This feature is similar to the so called shebang line on Unix-like systems which tells system how to execute script.</p>

<p>Open up new Command Prompt window, go to <code>c:\projects\misc</code> directory, type name of our script with extension and hit Enter. Result should be:</p>

<div class="highlight"><pre><code class="bat">c:\<span class="p">&gt;</span><span class="n">cd</span> projects\misc
c:\projects\misc<span class="p">&gt;</span><span class="n">ruby_args</span>.rb
No arguments supplied</code></pre></div>

<p>Now execute script but provide some arguments to it:</p>

<div class="highlight"><pre><code class="bat">c:\projects\misc<span class="p">&gt;</span><span class="n">ruby_args</span>.rb arg<span class="m">1</span> arg<span class="m">2</span> arg<span class="m">3</span>
Argument <span class="m">0</span> is: arg<span class="m">1</span>
Argument <span class="m">1</span> is: arg<span class="m">2</span>
Argument <span class="m">2</span> is: arg<span class="m">3</span></code></pre></div>

<p>You see that, with these file associations, there is no need to explicitly use ruby interpreter. Operating system will do that for us. Nevertheless you can still use it by giving full path to <code>ruby.exe</code> if you haven&#39;t added it to the path or by using <code>ruby.exe</code> or just ruby if it is in your path. All three versions are displayed below.</p>

<div class="highlight"><pre><code class="bat">c:\projects\misc<span class="p">&gt;</span><span class="n">c</span>:\Ruby\<span class="m">22</span>\bin\ruby.exe ruby_args.rb one two
Argument <span class="m">0</span> is: one
Argument <span class="m">1</span> is: two

c:\projects\misc<span class="p">&gt;</span><span class="n">ruby</span>.exe ruby_args.rb one two
Argument <span class="m">0</span> is: one
Argument <span class="m">1</span> is: two

c:\projects\misc<span class="p">&gt;</span><span class="n">ruby</span> ruby_args.rb one two
Argument <span class="m">0</span> is: one
Argument <span class="m">1</span> is: two</code></pre></div>

            <hr>
          </section>

      <section style="font-weight:bold; margin-bottom: 2em;">
        
        <a rel="prev" class="a-hover"href="/book/ch02-00.html"><i class="icon-double-angle-left"></i> Installing Ruby</a>
        
        
        <a rel="next" style="float:right" class="a-hover"href="/book/ch02-02.html">Building Ruby <i class=" icon-double-angle-right"></i></a>
        
      </section>
        </article>
      </div>
    </section>
  </main>
</body>
</html>
