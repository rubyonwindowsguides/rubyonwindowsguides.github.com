<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Ms Sql Server</title>
   <meta name="author" content="Boško Ivanišević" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/menu.css" type="text/css" media="screen, projection" />

   <!-- Update your html tag to include the itemscope and itemtype attributes -->
   <html itemscope itemtype="http://schema.org/Book">

   <!-- Add the following three tags inside head -->
   <meta itemprop="name" content="Ruby On Windows Guides">

   <!-- Place this render call where appropriate -->
   <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
   </script>

   <script type="text/javascript">

     var _gaq = _gaq || [];
     _gaq.push(['_setAccount', 'UA-26061460-1']);
     _gaq.push(['_trackPageview']);

     (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
     })();

   </script>
</head>
<body>
  <header>
  </header>
  <main class="content">
    <section class="container">
      <nav class="navbar-fixed-top">
        <div class="container">
          <a href="/">Book</a>
          <a href="/about.html">About</a>
          <span style="float: right;">
            <!-- Place this tag where you want the +1 button to render -->
            <g:plusone annotation="inline"></g:plusone>
          </span>
        </div>
      </nav>
      <div id="header">
        <table>
          <tr>
            <td>
              <h1>Ruby on Windows Guides</h1>
              <h4 class="title">by Boško Ivanišević</h4>
            </td>
          </tr>
        </table>
      </div>
      <div id="main" class="row-fluid">
        <article class="post">
      <section style="font-weight:bold; margin-bottom: 2em;">
        
        <a rel="prev" class="a-hover"href="/book/ch03-03.html"><i class="icon-double-angle-left"></i> Postgresql Database</a>
        
        
        <a rel="next" style="float:right" class="a-hover"href="/book/ch04-00.html">Programming On Windows <i class=" icon-double-angle-right"></i></a>
        
            <hr>
      </section>

          <section>
            <h2>MS SQL Server</h2>

<p>What is left is to learn is how to use database engine that is probably of the most interest for developers who work on Windows – Microsoft&#39;s SQL Server. If you do not have MS SQL Server installed go ahead and download MS SQL Server Express installer from Microsoft&#39;s site. I will use version 2014 in this book. Let&#39;s first create database that we will use in our Rails application:</p>

<div class="highlight"><pre><code class="bat">osql -b -S localhost -U <span class="p">&lt;</span><span class="n">your_sqlserver_admin_username</span>&gt; -P <span class="p">&lt;</span><span class="n">password_here</span>&gt; -Q <span class="s2">&quot;CREATE DATABASE RwinBookDevel COLLATE SQL_Latin1_General_CP1_CS_AS&quot;</span></code></pre></div>

<p>Newest rails adapter for MS SQL Server uses tiny_tds library to connect to MS SQL server and its usage is almost straigtforward. First thing we have to do is to add following two lines to Gemfile:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">gem</span> <span class="s1">&#39;tiny_tds&#39;</span>
<span class="n">gem</span> <span class="s1">&#39;activerecord-sqlserver-adapter&#39;</span></code></pre></div>

<p>and run <code>bundle install</code>. With all prerequisites met we can now configure our Ruby on Rails application to use SQL Server. Connection options are displayed below:</p>

<div class="highlight"><pre><code class="ruby"><span class="ss">development</span><span class="p">:</span>
  <span class="ss">adapter</span><span class="p">:</span> <span class="n">sqlserver</span>
  <span class="ss">mode</span><span class="p">:</span> <span class="n">dblib</span>
  <span class="ss">host</span><span class="p">:</span> <span class="n">localhost</span>
  <span class="ss">port</span><span class="p">:</span> <span class="mi">1433</span>
  <span class="ss">username</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">your_db_user_name</span><span class="o">&gt;</span>
  <span class="ss">password</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">your_db_password</span><span class="o">&gt;</span>
  <span class="ss">database</span><span class="p">:</span> <span class="no">RwinBookDevel</span></code></pre></div>

<p>This is all you need to use MS SQL server for Rails application. Pretty easy, isn&#39;t it.</p>

            <hr>
          </section>

      <section style="font-weight:bold; margin-bottom: 2em;">
        
        <a rel="prev" class="a-hover"href="/book/ch03-03.html"><i class="icon-double-angle-left"></i> Postgresql Database</a>
        
        
        <a rel="next" style="float:right" class="a-hover"href="/book/ch04-00.html">Programming On Windows <i class=" icon-double-angle-right"></i></a>
        
      </section>
        </article>
      </div>
    </section>
  </main>
</body>
</html>
